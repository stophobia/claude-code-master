import { Callout } from 'nextra/components'
import { DownloadMarkdown } from '../../components/DownloadMarkdown'
import { commandContents } from '../../components/commandContents'

# /refactor-clean (정리)

<DownloadMarkdown
  filename="refactor-clean.md"
  content={commandContents['refactor-clean']}
  folderPath="~/.claude/commands/"
/>

테스트 검증과 함께 안전하게 불필요한 코드 식별 및 제거.

<Callout type="info" emoji="🧹">
  **`refactor-cleaner` 에이전트**를 호출하여 불필요한 코드를 정리합니다.
</Callout>

## 이 커맨드가 하는 일

1. 불필요한 코드 분석 도구 실행:
   - `knip`: 사용되지 않는 익스포트와 파일 찾기
   - `depcheck`: 사용되지 않는 의존성 찾기
   - `ts-prune`: 사용되지 않는 TypeScript 익스포트 찾기

2. `.reports/dead-code-analysis.md`에 포괄적인 리포트 생성

3. 심각도별 발견 사항 분류:
   - **안전**: 테스트 파일, 사용되지 않는 유틸리티
   - **주의**: API 라우트, 컴포넌트
   - **위험**: 설정 파일, 메인 진입점

4. 안전한 삭제만 제안

5. 각 삭제 전:
   - 전체 테스트 스위트 실행
   - 테스트 통과 확인
   - 변경 적용
   - 테스트 재실행
   - 테스트 실패 시 롤백

6. 정리된 항목 요약 표시

## 사용 예시

```bash
# 불필요한 코드 정리
/refactor-clean

# 출력 예시
## 불필요한 코드 분석

### 안전 (바로 삭제 가능)
- src/utils/old-helper.ts - 마지막 사용: 없음
- src/components/DeprecatedButton.tsx - 참조 없음

### 주의 (검토 필요)
- src/api/legacy-endpoint.ts - 동적 임포트 가능성

### 위험 (삭제 금지)
- src/config/index.ts - 메인 진입점

## 삭제 진행

1. src/utils/old-helper.ts 삭제
   - 테스트 실행... ✅ 통과
   - 삭제됨

2. src/components/DeprecatedButton.tsx 삭제
   - 테스트 실행... ✅ 통과
   - 삭제됨

## 요약
- 삭제된 파일: 2
- 제거된 코드 라인: 150
- 번들 크기 감소: ~5 KB
```

## 분석 명령어

```bash
# 사용되지 않는 익스포트/파일/의존성
npx knip

# 사용되지 않는 의존성
npx depcheck

# 사용되지 않는 TypeScript 익스포트
npx ts-prune
```

<Callout type="error" emoji="⚠️">
  **테스트 먼저 실행하지 않고 절대 코드 삭제 금지!** 의심될 때는 제거하지 마세요.
</Callout>
