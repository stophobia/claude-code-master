import { Callout } from 'nextra/components'
import { DownloadMarkdown } from '../../components/DownloadMarkdown'
import { ruleContents } from '../../components/ruleContents'

# 성능

<DownloadMarkdown
  filename="performance.md"
  content={ruleContents['performance']}
  folderPath="~/.claude/rules/"
/>

모델 선택 및 컨텍스트 윈도우 관리 규칙입니다.

## 모델 선택 전략

| 모델 | 특징 | 사용 시점 |
|------|------|----------|
| **Haiku 4.5** | Sonnet 능력의 90%, 비용 3배 절감 | 경량 에이전트, 워커 |
| **Sonnet 4.5** | 최고의 코딩 모델 | 메인 개발, 오케스트레이션 |
| **Opus 4.5** | 가장 깊은 추론 | 아키텍처 결정, 리서치 |

### Haiku 적합 작업

- 자주 호출되는 경량 에이전트
- 페어 프로그래밍과 코드 생성
- 멀티 에이전트 시스템의 워커 에이전트

### Sonnet 적합 작업

- 메인 개발 작업
- 멀티 에이전트 워크플로우 오케스트레이션
- 복잡한 코딩 작업

### Opus 적합 작업

- 복잡한 아키텍처 결정
- 최대 추론 요구사항
- 리서치 및 분석 작업

## 컨텍스트 윈도우 관리

<Callout type="error" emoji="⚠️">
  컨텍스트 윈도우의 **마지막 20%**에서는 복잡한 작업을 피하세요!
</Callout>

### 피해야 할 작업 (마지막 20%)

- 대규모 리팩토링
- 여러 파일에 걸친 기능 구현
- 복잡한 상호작용 디버깅

### 낮은 컨텍스트 민감도 작업

- 단일 파일 편집
- 독립적인 유틸리티 생성
- 문서 업데이트
- 간단한 버그 수정

## MCP 서버 관리

<Callout type="warning" emoji="🧠">
  MCP를 너무 많이 활성화하면 컨텍스트 윈도우가 70k로 줄어들 수 있습니다!
</Callout>

| 권장 | 설명 |
|------|------|
| 20-30개 | 설정해둘 MCP 수 |
| 10개 미만 | 프로젝트당 활성화할 MCP |
| 80개 미만 | 활성 도구 수 |

### 비활성화 방법

프로젝트 설정에서 `disabledMcpServers` 사용:

```json
{
  "disabledMcpServers": [
    "server-1",
    "server-2"
  ]
}
```

## Ultrathink + Plan Mode

깊은 추론이 필요한 복잡한 작업:

1. 향상된 사고를 위해 `ultrathink` 사용
2. 구조화된 접근을 위해 **Plan Mode** 활성화
3. 여러 번의 비평 라운드로 "엔진 예열"
4. 다양한 분석을 위해 역할 분리 서브 에이전트 사용

## 빌드 문제 해결

빌드 실패 시:

1. **build-error-resolver** 에이전트 사용
2. 오류 메시지 분석
3. 점진적으로 수정
4. 각 수정 후 검증
